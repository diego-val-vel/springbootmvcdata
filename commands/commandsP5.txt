# ===
# Práctica 5
# ===

# Cambiarse a la rama
cd /springbootmvcdata
git checkout feature/practica5

# Dentro del contenedor
cd /workspace
./mvnw clean spring-boot:run

# Verificar la información creada

-- en el contenedor de spring
docker compose exec springdev bash
psql -h postgres -U appuser -d hotelbook

-- en el contenedor de postgresql
docker compose exec postgres bash
psql -U appuser -d hotelbook

-- querys básicos
SELECT * FROM rooms;
SELECT * FROM guests;
SELECT * FROM bookings;

-- Endpoints que involucran a la BD
http://localhost:8080/rooms
http://localhost:8080/api/rooms
http://localhost:8080/api/rooms/1

-- Endpoints de búsqueda sobre rooms
curl "http://localhost:8080/api/rooms/search?page=0&size=5"
curl "http://localhost:8080/api/rooms/search?name=Deluxe&page=0&size=10"
curl "http://localhost:8080/api/rooms/search?minPrice=1000&maxPrice=2500&sort=price&direction=asc"
curl "http://localhost:8080/api/rooms/search?name=Suite&minPrice=2000&maxPrice=4000"

-- Endpoint para crear nueva habitación
curl -X POST "http://localhost:8080/api/rooms" \
  -H "Content-Type: application/json" \
  -d '{
        "code": "STD-999",
        "name": "Standard Demo 999",
        "capacity": 2,
        "basePricePerNight": 850.00
      }'

-- Confirmación
SELECT * FROM rooms WHERE code = 'STD-999';

-- Corroborar sequence
SELECT last_value FROM rooms_id_seq;
SELECT MAX(id) FROM rooms;

-- Consultar el detalle, (usar el id anterior)
curl "http://localhost:8080/api/rooms/5"

-- Endpoint para hacer actualización, (usar el id anterior)
curl -X PUT "http://localhost:8080/api/rooms/3" \
  -H "Content-Type: application/json" \
  -d '{
        "name": "Standard Demo 999 (Renovada)",
        "capacity": 3,
        "basePricePerNight": 900.00,
        "active": true
      }'

-- Confirmación
SELECT * FROM rooms WHERE id = 7;

-- Endpoint para eliminar una habitación, (usar el id anterior)
curl -X DELETE "http://localhost:8080/api/rooms/7"

-- Confirmación
SELECT * FROM rooms WHERE id = 7;
